// Source code is decompiled from a .class file using FernFlower decompiler.
package com.techlabs.app.controller;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.techlabs.app.dto.JWTAuthResponse;
import com.techlabs.app.dto.LoginDto;
import com.techlabs.app.dto.RegisterDto;
import com.techlabs.app.service.AuthService;
import org.slf4j.LoggerFactory;
import org.slf4j.Logger;

@RestController
@RequestMapping({"/api/auth"})
public class AuthController {
   private AuthService authService;
   
   

   public AuthController(AuthService authService) {
      this.authService = authService;
   }

   @PostMapping({"/login", "/signin"})
   public ResponseEntity<JWTAuthResponse> login(@RequestBody LoginDto loginDto) {
      String token = this.authService.login(loginDto);
      System.out.println(loginDto);
      JWTAuthResponse jwtAuthResponse = new JWTAuthResponse();
      jwtAuthResponse.setAccessToken(token);
      return ResponseEntity.ok(jwtAuthResponse);
   }

   @PostMapping({"/register", "/signup"})
   public ResponseEntity<String> register(@RequestBody RegisterDto registerDto) {
      String response = this.authService.register(registerDto);
      return new ResponseEntity(response, HttpStatus.CREATED);
   }
}
